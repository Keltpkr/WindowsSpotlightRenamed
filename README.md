# 🌟 Windows Spotlight Image Renamer

## 🎯 Project Description

This project processes and renames images downloaded by Windows Spotlight. It filters images based on their orientation (landscape only) and generates descriptive filenames using the BLIP (Bootstrapped Language-Image Pre-training) model.

The renamed images are stored in a specified directory, with filenames reflecting their content, such as `a_large_rock_formation.jpg`.

---

## ⚙️ Technical Requirements

### 📦 Dependencies

- **Python 3.11** (Required to install dependencies for the BLIP model)
- **Required Python libraries:**
  - `Pillow` (Image processing library)
  - `transformers` (Hugging Face library for the BLIP model)
  - `torch` (PyTorch backend for the model)

### 🗂️ Files and Models
- BLIP model files:
  - `config.json`
  - `pytorch_model.bin`
  - `preprocessor_config.json`
  - `special_tokens_map.json`
  - `tokenizer_config.json`
  - `vocab.txt`
- Download the BLIP model from [Salesforce/blip-image-captioning-base](https://huggingface.co/Salesforce/blip-image-captioning-base).

---

## 🛠️ How to Set Up the Project

### 1️⃣ Clone the Repository
```bash
git clone https://github.com/yourusername/windows-spotlight-image-renamer.git
cd windows-spotlight-image-renamer
```

### 2️⃣ Install the Dependencies
Install the required Python packages using `pip`:
```bash
C:\Users\<YourUsername>\AppData\Local\Programs\Python\Python311\python.exe -m pip install Pillow transformers torch
```

### 3️⃣ Set Up the BLIP Model
1. Download the model files from [Salesforce/blip-image-captioning-base](https://huggingface.co/Salesforce/blip-image-captioning-base).
2. Place the files in a local directory, e.g., `C:\Models\blip-image-captioning-base`.

Ensure the directory contains the following:
```
C:\Models\blip-image-captioning-base\
├── config.json
├── pytorch_model.bin
├── preprocessor_config.json
├── special_tokens_map.json
├── tokenizer_config.json
└── vocab.txt
```

---

## 🚀 How to Run the Script

1. Ensure the source and destination directories are correctly set in the script:
   ```python
   source_dir = r"C:\Users\<YourUsername>\AppData\Local\Packages\Microsoft.Windows.ContentDeliveryManager_cw5n1h2txyewy\LocalState\Assets"
   destination_dir = r"C:\Users\<YourUsername>\Pictures\WindowsSpotlightRenamed"
   model_path = r"C:\Models\blip-image-captioning-base"
   ```

2. Run the script using Python 3.11:
   ```bash
   C:\Users\<YourUsername>\AppData\Local\Programs\Python\Python311\python.exe SaveSpotlightImages.py
   ```

---

## 🌈 Features
- 📂 Processes Windows Spotlight images.
- 🖼️ Filters images to include only landscape orientation.
- 📝 Renames images with descriptive filenames generated by the BLIP model.

---

## 📸 Example Output
Renamed images will be saved in the destination folder with descriptive filenames, such as:
```
C:\Users\<YourUsername>\Pictures\WindowsSpotlightRenamed\
├── a_large_rock_formation.jpg
├── a_view_of_a_city_at_night_from_a_hill.jpg
└── the_rocky_coastline_of_the_mediterranean_island_of_rhodes.jpg
```

### Examples
#### 1. A Large Rock Formation
![A Large Rock Formation](a_large_rock_formation_resized.jpg)

#### 2. A View of a City at Night from a Hill
![A View of a City at Night](a_view_of_a_city_at_night_from_a_hill_resized.jpg)

#### 3. The Rocky Coastline of the Mediterranean Island of Rhodes
![Rocky Coastline](the_rocky_coastline_of_the_mediterranean_island_of_rhodes_resized.jpg)

---

## 🛠️ Troubleshooting

### ⚠️ Common Issues

#### 1. 🔒 Locked Files
- **Error**: `[WinError 32] The process cannot access the file because it is being used by another process.`
- **Solution**: Ensure no other applications (e.g., OneDrive, antivirus) are accessing the files.

#### 2. 📁 Missing Model Files
- **Error**: `Error loading the BLIP model: ...`
- **Solution**: Verify that all BLIP model files are in the specified directory.

#### 3. ❌ Missing Dependencies
- **Error**: `ModuleNotFoundError: No module named '...'`
- **Solution**: Install the missing dependency using `pip install <package_name>`.

---

## 🤝 Contribution
Feel free to fork this repository and submit pull requests for new features or bug fixes. 🌟

---

## 📜 License
This project is licensed under the MIT License. See the LICENSE file for details.
